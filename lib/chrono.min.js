(function(){var e,t,n,r,i=[].slice;e=function(){function e(){var e,t,r,s;r=arguments[0],t=2<=arguments.length?i.call(arguments,1):[],r==null&&(r={}),this.handlers=t,s=typeof r;if(s==="number"||s==="string")r={precision:this.toMilliseconds(r)};e={precision:1e3,from:0,to:void 0,keepGoing:!1},r.precision&&(r.precision=this.toMilliseconds(r.precision)),r.from&&(r.from=this.toMilliseconds(r.from)),r.to&&(r.to=this.toMilliseconds(r.to)),this.settings=n(e,r),this.reset()}return e.prototype.start=function(){var e=this;return this.__handle?this:(this.__callHandlers(),this.__handle=setInterval(function(t){return e.__tick(t)},this.settings.precision),this.ticking=!0,this)},e.prototype.stop=function(){return this.__handle&&clearInterval(this.__handle),this.__handle=null,this.ticking=!1,this},e.prototype.reset=function(e){return this.__ms=e!=null?e:this.settings.from,this.__ms=this.toMilliseconds(this.__ms),this.stop(),this},e.prototype.bind=function(){var e,t,n,r,s;t=1<=arguments.length?i.call(arguments,0):[],s=[];for(n=0,r=t.length;n<r;n++)e=t[n],s.push(this.handlers.push(e));return s},e.prototype.unbind=function(){var e,t,n,r,s,o,u,a,f;n=1<=arguments.length?i.call(arguments,0):[];for(s=0,u=n.length;s<u;s++){t=n[s],f=this.handlers;for(r=o=0,a=f.length;o<a;r=++o)e=f[r],e===t&&this.handlers.splice(r,1)}return this},e.prototype.time=function(e){var t;return t=this.__newDate(this.__ms),e&&(t=this.__applyDateChanges(t,e),this.__ms=t.getTime()),this.__timeObject(t)},e.prototype.toMilliseconds=function(e){var t;t=0;switch(typeof e){case"number":t=e;break;case"string":t=this.__stringToMilliseconds(e);break;case"object":t=this.__objectToMilliseconds(e);break;default:throw new Error("unknow format : "+e)}return Math.floor(t)},e.prototype.__tick=function(){return this.__ms+=this.settings.precision,!this.settings.keepGoing&&this.__ms>=this.settings.to&&this.stop(),this.__callHandlers(),this},e.prototype.__callHandlers=function(){var e,t,n,r;r=this.handlers;for(t=0,n=r.length;t<n;t++)e=r[t],e(this.__ms,this,this.__ms>=this.settings.to);return this},e.prototype.__applyDateChanges=function(e,t){var n,r,i,s,o;i=/([+\-*\/]?)(\d+)(ms|[tsmh])\s?/g,r=[];while(n=i.exec(t))r.push(n);for(s=0,o=r.length;s<o;s++)n=r[s],e=this.__dateSingleChange(e,n);return e},e.prototype.__dateSingleChange=function(e,t){var n,r,i,s,o;s=t[0],r=t[1],o=t[2],i=t[3],o=parseInt(o),n=0;if(r!==void 0){switch(i){case"ms":n=e.getMilliseconds();break;case"s":n=e.getSeconds();break;case"m":n=e.getMinutes();break;case"h":n=e.getHours()}switch(r){case"+":n+=o;break;case"-":n-=o;break;case"*":n*=o;break;case"/":n/=o;break;case"":n=o}}switch(i){case"ms":e.setMilliseconds(n);break;case"s":e.setSeconds(n);break;case"m":e.setMinutes(n);break;case"h":e.setHours(n)}return e},e.prototype.__timeObject=function(e){var t;return t={ms:e.getMilliseconds(),s:e.getSeconds(),m:e.getMinutes(),h:e.getHours(),t:e.getTime()}},e.prototype.__newDate=function(e){return new t(e)},e.prototype.__objectToMilliseconds=function(e){var t;return t=0,typeof e.ms=="number"&&(t+=e.ms),typeof e.s=="number"&&(t+=e.s*1e3),typeof e.m=="number"&&(t+=e.m*6e4),typeof e.h=="number"&&(t+=e.h*36e5),t},e.prototype.__stringToMilliseconds=function(e){var t,n,r,i,s,o;n=/(\d+)(ms|[tsmh])\s?/g,t=0,i=[];while(r=n.exec(e))i.push(r);for(s=0,o=i.length;s<o;s++)r=i[s],t+=this.__subStringToMilliseconds(r);return t},e.prototype.__subStringToMilliseconds=function(e){var t,n,r,i;i=e[0],n=e[1],r=e[2],n=parseInt(n),t=0;switch(r){case"ms":t=n;break;case"s":t=n*1e3;break;case"m":t=n*6e4;break;case"h":t=n*36e5}return t},e}(),n=function(e,t){var n,r;for(n in t)r=t[n],e[n]=r;return e},t=function(){function e(e){this.__ms=e!=null?e:0,this}return e.prototype.getTime=function(){return this.__ms},e.prototype.getMilliseconds=function(){return this.__ms%1e3},e.prototype.getSeconds=function(){return Math.floor(this.__ms/1e3)%60},e.prototype.getMinutes=function(){return Math.floor(this.__ms/6e4)%60},e.prototype.getHours=function(){return Math.floor(this.__ms/36e5)},e.prototype.setTime=function(e){return this.__ms=e,this.__ms},e.prototype.setMilliseconds=function(e){return this.__ms=this.__ms-this.getMilliseconds()+e},e.prototype.setSeconds=function(e){var t;return t=(e-this.getSeconds())*1e3,this.__ms=this.__ms+t},e.prototype.setMinutes=function(e){var t;return t=(e-this.getMinutes())*6e4,this.__ms=this.__ms+t},e.prototype.setHours=function(e){var t;return t=(e-this.getHours())*36e5,this.__ms=this.__ms+t},e}(),r=typeof exports!="undefined"&&exports!==null?exports:this,r.Chrono=e}).call(this);